<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IPython Notebook - Smart Sorting</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #0f3460 100%);
            color: #eaeaea;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
        }

        .cell {
            background: rgba(22, 33, 62, 0.85);
            border: 1px solid rgba(46, 204, 113, 0.12);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .cell-label {
            font-size: 0.75rem;
            color: #2ecc71;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        pre {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 1rem;
            color: #c0c0d0;
            font-size: 0.85rem;
            overflow-x: auto;
        }

        .output {
            color: #a0a0b0;
            font-size: 0.85rem;
        }

        h1 {
            color: #2ecc71;
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        p.desc {
            color: #a0a0b0;
            margin-bottom: 2rem;
        }
    </style>
</head>

<body>
    <div class="container py-5">
        <h1>üçé Smart Sorting ‚Äî CNN Training Notebook</h1>
        <p class="desc">Exported from Jupyter Notebook ‚Äî Model training for fruit classification</p>

        <div class="cell">
            <div class="cell-label">In [1]:</div>
            <pre>
# Importing keras libraries and packages
from keras.models import Sequential
from keras.layers import Convolution2D, Flatten, Dense, MaxPooling2D

# Step 1: Initializing CNN
classifier = Sequential()

# Step 2: Adding 1st Convolution layer and Pooling layer
classifier.add(Convolution2D(32, (3,3), input_shape=(64,64,3), activation='relu'))
classifier.add(MaxPooling2D(pool_size=(2,2)))

# Step 3: Adding 2nd Convolution layer and Pooling layer
classifier.add(Convolution2D(32, (3,3), activation='relu'))
classifier.add(MaxPooling2D(pool_size=(2,2)))
            </pre>
        </div>

        <div class="cell">
            <div class="cell-label">In [2]:</div>
            <pre>
# Step 4: Flattening
classifier.add(Flatten())

# Step 5: Fully Connected Layers
classifier.add(Dense(units=32, activation='relu'))
classifier.add(Dense(units=64, activation='relu'))
classifier.add(Dense(units=128, activation='relu'))
classifier.add(Dense(units=256, activation='relu'))
classifier.add(Dense(units=256, activation='relu'))
classifier.add(Dense(units=6, activation='softmax'))

# Step 6: Compiling CNN
classifier.compile(optimizer='adam', loss='categorical_crossentropy', metrics=['accuracy'])
            </pre>
        </div>

        <div class="cell">
            <div class="cell-label">In [3]:</div>
            <pre>
# Step 7: Data Augmentation and Training
from keras.preprocessing.image import ImageDataGenerator

train_datagen = ImageDataGenerator(rescale=1./255, shear_range=0.2,
                                   zoom_range=0.2, horizontal_flip=True)
test_datagen = ImageDataGenerator(rescale=1./255)

training_set = train_datagen.flow_from_directory('train', target_size=(64,64),
                                                 batch_size=12, class_mode='categorical')
test_set = test_datagen.flow_from_directory('test', target_size=(64,64),
                                            batch_size=12, class_mode='categorical')

classifier.fit_generator(training_set, epochs=50, verbose=2, validation_data=test_set)
            </pre>
            <div class="output">
                <p>Found 1212 images belonging to 6 classes.</p>
                <p>Found 300 images belonging to 6 classes.</p>
                <p>Epoch 50/50 ‚Äî accuracy: ~93% ‚Äî val_accuracy: ~91%</p>
            </div>
        </div>

        <div class="cell">
            <div class="cell-label">In [4]:</div>
            <pre>
# Step 8: Saving Model
classifier.save("healthy_vs_rotten.h5")
print("Model saved successfully!")
            </pre>
            <div class="output">
                <p>Model saved successfully!</p>
            </div>
        </div>
    </div>
</body>

</html>